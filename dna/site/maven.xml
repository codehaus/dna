<?xml version="1.0"?>
<project default="main"
    xmlns:j="jelly:core"
    xmlns:maven="jelly:maven"
    xmlns:ant="jelly:ant">

    <goal name="main">
        <attainGoal name="build"/>
    </goal>

    <goal name="build">
        <attainGoal name="site:generate"/>
    </goal>

    <goal name="deploy">
        <attainGoal name="site:deploy"/>
    </goal>

    <preGoal name="xdoc:init">
        <attainGoal name="aggregate-components"/>
    </preGoal>

    <!--
       Build a single site documentation for whole set of DNA projects.
    -->
    <goal name="aggregate-components">
        <echo message="Aggregate components by source"/>
        <ant:mkdir dir="${maven.build.dir}/aggregate-src/java"/>
        <ant:copy todir="${maven.build.dir}/aggregate-src/java">
            <ant:fileset dir="${basedir}/../api/src/java"/>
            <ant:fileset dir="${basedir}/../impl/src/java"/>
        </ant:copy>
        <ant:mkdir dir="${maven.build.dir}/aggregate-src/test"/>
        <ant:copy todir="${maven.build.dir}/aggregate-src/test">
            <ant:fileset dir="${basedir}/../api/src/test"/>
            <ant:fileset dir="${basedir}/../impl/src/test"/>
        </ant:copy>
    </goal>

</project>
